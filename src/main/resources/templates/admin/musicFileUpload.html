<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>我的哔哩哔哩-视频上传</title>

    <link th:href="@{../../Homepage/mycssAndimg/css.css}" rel="stylesheet"/>

    <script th:src="@{../../Homepage/js/jquery-2.0.0.js}"></script>

</head>
<style>

</style>
<body>
<div id="none">
    <!-- style="width: 100%;height: 60px;background-color: white;" -->
</div>

<div style="position:relative;left: 30%;">

    <div>

        <form id="upload_form" th:action="@{/uploadMusic}" method="post" style="background-color: white" enctype="multipart/form-data">

            <div>
                <div><label style="color: black;">请选择音乐文件</label></div>
                <div><input type="file" name="file" id="music"/></div>
            </div>
            <div>
                <div><label style="color: black;">请选择音乐封面</label></div>
                <div><input type="file" name="file" id="musicImg"/></div>
            </div>
            <div>
                <div><label style="color: black;">请输入歌曲名</label></div>
                <div><input type="text" name="musicName" id="musicName"/></div>
            </div>

            <div>
                <div><label style="color: black;">请输入歌手名</label></div>
                <div><input type="text" name="singer" id="singer"/></div>
            </div>

            <div>
                <div><label style="color: black;">请选择歌曲分类</label></div>
                <div>
                    <label><input name="musicAtegory" type="radio" value="1" checked/>韩语 </label>
                    <label><input name="musicAtegory" type="radio" value="2"/>华语 </label>
                    <label><input name="musicAtegory" type="radio" value="3"/>欧美 </label>
                    <label><input name="musicAtegory" type="radio" value="4"/>日语 </label>
                    <label><input name="musicAtegory" type="radio" value="5"/>粤语 </label>
                </div>
                <div><label style="color: black;">请选择是否为付费</label></div>
                <div>
                    <label><input name="musicState" type="radio" value="1" checked/>普通 </label>
                    <label><input name="musicState" type="radio" value="2"/>VIP </label>
                </div>
            </div>
            <div>
                <input type="button" id="tougao" value="确认"/>
                <input type="button" id="fanhui" value="取消返回"/>
                <input type="submit" id="submit" value="立即投稿" disabled="disabled"/>
            </div>
            <!--/*@thymesVar id="MusicUploadFeedback" type="java"*/-->
            <p th:if="${MusicUploadFeedback}" style="text-align: center">
                <span style="color: red" th:text="${MusicUploadFeedback}"></span>
            </p>

            <!--/*@thymesVar id="VideoUploadSuccess" type="java"*/-->
            <p th:if="${MusicUploadSuccess}" style="text-align: center">
                <span style="color: green" th:text="${MusicUploadSuccess}"></span>
            </p>

        </form>
        <div style="display: none;" id="totalSize"><b style="color: red;">总大小不能超过1g</b></div>

    </div>
</div>
    <script type="text/javascript">
        $("#fanhui").click(function () {
            location.href = "index";
        })

    </script>

    <script>
        $("#tougao").click(function () {
            //判断视频
            var music = $("#music").val();
            if (music == "") {
                alert("请上传投稿的视频");
                return false;
            } else {
                if (!/\.(mp3)$/.test(music)) {
                    alert("音乐格式必须为.MP3格式")
                    return false;
                }
                //判断图片
                var musicImg = $("#musicImg").val();
                if (musicImg == "") {
                    alert("请选择图片");
                    return false;
                } else {
                    if (!/\.(gif|jpg|jpeg|png|GIF|JPG|PNG)$/.test(musicImg)) {
                        alert("图片类型必须是.gif,jpeg,jpg,png中的一种")
                        return false;
                    }
                }
                //开始判断输入的内容
                var musicName = $("#musicName").val();
                var miaoshu = $("#miaoshu").val();
                if (musicName == "" || singer == "" || singer == "null" || musicName == "null") {
                    alert("请输入歌曲名和歌手名");
                    return false;
                }
                //判断文件总大小 不能超1g
                //用户上传的音乐
                var addMusic = $("#music").prop('files');
                var fileSize = 0;
                for (var i = 0; i < addMusic.length; i++) {
                    fileSize = $(addMusic)[i].size;
                }
                //用户上传的图片
                var addImags = $("#musicImg").prop('files');
                var fileSize2 = 0;
                for (var i = 0; i < addImags.length; i++) {
                    fileSize2 = $(addImags)[i].size;
                }

                var totalSize = fileSize + fileSize2;
                var maxSize = 104857600;
                if (totalSize > maxSize) {
                    $("#totalSize").show();
                    alert("对不起 文件过大.无法上传");
                    return false;
                }

            }
            //判断结束
            $("#tougao").attr('disabled', true); //将button变成不可点击
            $("#submit").attr('disabled', false); //将button变成不可点击
        });


    </script>
    <!--         要想获取某个radio的值有以下的几种方法,直接给出代码：
    1、
    1.$('input[name="testradio"]:checked').val();2、
    1.$('input:radio:checked').val();3、
    1.$('input[@name="testradio"][checked]');4、
    1.$('input[name="testradio"]').filter(':checked');差不多挺全的了，如果我们要遍历name为testradio的所有radio呢，代码如下
    1.$('input[name="testradio"]').each(function(){2.alert(this.value);3.});如果要取具体某个radio的值，比如第二个radio的值，这样写
    1.$('input[name="testradio"]:eq(1)').val() -->
</body>


</html>